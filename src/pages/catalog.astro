---
import Layout from "../layouts/Layout.astro";
import { SearchableTableDisplay } from "../components/SearchableTableDisplay";

// Import direct data from JSON
import CoursesRaw from "../../migration/json/2025-1.json";
import Id2NameRaw from "../../migration/json/valores_unicos.json";
import type { Course } from "../components/table/columns";

// Get search parameter from URL
const searchParam = Astro.url.searchParams.get('search') || '';

// Prepare data
const coursesData = CoursesRaw as Record<string, any>;
const id2name: Record<string, string> = Id2NameRaw as Record<string, string>;

// Transform the JSON data directly into the format needed by the table
const coursesWithNames = Object.entries(coursesData).map(([sigle, details]) => ({
  sigle: sigle,
  name: details.name || 'Nombre no disponible',
  credits: details.credits || 0,
  school: details.school || 'No disponible',
  area: details.area || 'No disponible'
})) as Course[];
---

<Layout title="CatÃ¡logo de Cursos">
  <SearchableTableDisplay data={coursesWithNames} initialSearchValue={searchParam} client:only="react" />
</Layout>
