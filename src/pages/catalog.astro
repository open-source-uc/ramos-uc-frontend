---
import Layout from "../layouts/Layout.astro";
import { SearchableTableDisplay } from "../components/SearchableTableDisplay";

// Import direct data from JSON
import CoursesRaw from "../../migration/json/2025-1.json";
import Id2NameRaw from "../../migration/json/valores_unicos.json";

// Get search parameter from URL
const searchParam = Astro.url.searchParams.get("search") || "";

// Prepare data
const coursesData = CoursesRaw as Record<string, any>;
const id2name: Record<string, string> = Id2NameRaw as Record<string, string>;

// Get dynamic course data from database
// hola
// Create a map for quick lookup of course summaries by sigle

// Transform the JSON data directly into the format needed by the table
const coursesWithNames = Object.entries(coursesData).map(
  ([sigle, details], index) => {
    return {
      id: index + 1, // Generate a simple id
      sigle: sigle,
      name: details.name,
      credits: details.credits,
      school: details.school,
      area: details.area,
      category: details.category,
      superlikes: 0,
      likes: 0,
      dislikes: 0,
    };
  },
);
---

<Layout title="CatÃ¡logo de Cursos">
  <SearchableTableDisplay
    data={coursesWithNames}
    initialSearchValue={searchParam}
    client:only="react"
  />
</Layout>
